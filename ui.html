<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yatrafy AI MVP Demo</title>
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React and ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel to convert JSX to JavaScript -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <style>
        /* Hide scrollbar for clean UI */
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
        body { background-color: #e5e7eb; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen py-5">

    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Simple SVG Icons components to replace external library
        const IconAI = () => <div className="w-8 h-8 bg-indigo-600 rounded-full flex items-center justify-center text-white text-xs font-bold">AI</div>;
        const IconUser = () => <div className="w-8 h-8 bg-gray-500 rounded-full flex items-center justify-center text-white text-xs font-bold">U</div>;
        const IconPlane = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12h20"/><path d="m13 2 9 10-9 10"/><path d="M2 12 13 2"/><path d="M2 12l11 10"/></svg>; // Arrow actually, for simplicity
        const IconCheck = () => <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-green-600"><polyline points="20 6 9 17 4 12"></polyline></svg>;
        const IconSend = () => <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="22" y1="2" x2="11" y2="13"></line><polygon points="22 2 15 22 11 13 2 9 22 2"></polygon></svg>;

        const YatrafyChat = () => {
            const [messages, setMessages] = useState([
                {
                id: 1,
                sender: 'bot',
                type: 'text',
                content: "Hi there! I'm your Yatrafy Assistant. üåç Where are we going today? You can speak naturally."
                }
            ]);
            const [input, setInput] = useState('');
            const [step, setStep] = useState(0);
            const [isTyping, setIsTyping] = useState(false);
            const chatEndRef = useRef(null);

            const scrollToBottom = () => {
                chatEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [messages, isTyping]);

            const handleSend = () => {
                if (!input.trim() && step === 0) return;
                
                if (step === 0) {
                    const userText = input;
                    addMessage('user', 'text', userText);
                    setInput('');
                    setStep(1);
                    
                    simulateBotResponse(() => {
                        addMessage('bot', 'text', "Got it. Searching for flights to Bengaluru for next Tuesday (Morning) to Wednesday. Here are the best options:");
                        setTimeout(() => {
                            addMessage('bot', 'flights', null);
                        }, 800);
                    });
                }
            };

            const handleFlightSelect = () => {
                addMessage('user', 'text', "Selected Option 1: Indigo 6E-405 (06:00 AM)");
                simulateBotResponse(() => {
                    addMessage('bot', 'text', "Great choice. Since your meeting is in Koramangala, I've found highly-rated hotels nearby to avoid traffic.");
                    setTimeout(() => {
                        addMessage('bot', 'hotels', null);
                    }, 800);
                });
            };

            const handleHotelSelect = () => {
                addMessage('user', 'text', "Let's go with The Grand Mercure.");
                simulateBotResponse(() => {
                    addMessage('bot', 'text', "Noted. Would you like to add a pre-booked airport cab? It's likely to rain Tuesday evening.");
                    setTimeout(() => {
                        addMessage('bot', 'extras', null);
                    }, 500);
                });
            };

            const handleExtrasSelect = (choice) => {
                addMessage('user', 'text', choice === 'yes' ? "Yes, add the cab." : "No, thanks.");
                simulateBotResponse(() => {
                    addMessage('bot', 'text', "Perfect. Here is your trip summary.");
                    setTimeout(() => {
                        addMessage('bot', 'summary', null);
                    }, 800);
                });
            };

            const handlePayment = () => {
                addMessage('user', 'text', "Processing Payment...");
                setTimeout(() => {
                    addMessage('bot', 'payment_success', null);
                }, 2000);
            };

            const simulateBotResponse = (callback) => {
                setIsTyping(true);
                setTimeout(() => {
                    setIsTyping(false);
                    callback();
                }, 1500);
            };

            const addMessage = (sender, type, content) => {
                setMessages(prev => [...prev, { id: Date.now(), sender, type, content }]);
            };

            return (
                <div className="w-full max-w-md bg-white h-[750px] border-[10px] border-gray-900 rounded-[3rem] overflow-hidden shadow-2xl relative flex flex-col font-sans mx-auto">
                    {/* Status Bar */}
                    <div className="bg-white px-6 pt-4 pb-2 flex justify-between items-center text-xs font-semibold text-gray-800 border-b z-20">
                        <span>9:41</span>
                        <div className="flex gap-1">
                            <span className="h-3 w-3 bg-black rounded-full"></span>
                            <span className="h-3 w-3 bg-black rounded-full"></span>
                            <span className="h-3 w-3 bg-black rounded-full opacity-50"></span>
                        </div>
                    </div>

                    {/* App Header */}
                    <div className="bg-white p-4 shadow-sm z-10 flex items-center gap-3">
                        <div className="w-10 h-10 bg-indigo-600 rounded-full flex items-center justify-center text-white font-bold text-xl">Y</div>
                        <div>
                            <h1 className="font-bold text-gray-900 text-lg">Yatrafy AI</h1>
                            <p className="text-xs text-green-500 flex items-center gap-1">‚óè Online ‚Ä¢ Corporate Mode</p>
                        </div>
                    </div>

                    {/* Chat Area */}
                    <div className="flex-1 overflow-y-auto p-4 space-y-4 bg-slate-50 relative">
                        <div className="text-center text-xs text-gray-400 my-2">Today</div>
                        
                        {messages.map((msg) => (
                        <div key={msg.id} className={`flex ${msg.sender === 'user' ? 'justify-end' : 'justify-start'}`}>
                            
                            {msg.sender === 'bot' && <div className="mr-2 mt-1"><IconAI /></div>}

                            <div className={`max-w-[85%] ${msg.type === 'text' ? (msg.sender === 'user' ? 'bg-indigo-600 text-white rounded-br-none' : 'bg-white text-gray-800 border border-gray-200 rounded-bl-none') : 'w-full'} rounded-2xl p-3 text-sm shadow-sm`}>
                            
                            {/* Text Message */}
                            {msg.type === 'text' && <p>{msg.content}</p>}

                            {/* Flight Cards */}
                            {msg.type === 'flights' && (
                                <div className="space-y-3 w-full">
                                    <div className="bg-white p-3 rounded-xl border hover:border-indigo-500 cursor-pointer transition-all shadow-sm" onClick={handleFlightSelect}>
                                        <div className="flex justify-between items-center mb-2">
                                            <div className="flex gap-2 items-center">
                                                <span className="font-bold text-gray-800">‚úàÔ∏è Indigo 6E-405</span>
                                            </div>
                                            <span className="font-bold text-green-600">‚Çπ4,200</span>
                                        </div>
                                        <div className="flex justify-between text-xs text-gray-500">
                                            <div>06:00 DEL</div>
                                            <div className="text-gray-300">----- 2h -----</div>
                                            <div className="text-right">08:45 BLR</div>
                                        </div>
                                        <div className="mt-2 text-xs bg-green-50 text-green-700 px-2 py-1 rounded inline-block">Best for 10am Meeting</div>
                                        <button className="mt-3 w-full bg-indigo-50 text-indigo-700 py-1.5 rounded-lg text-xs font-bold">Select Flight</button>
                                    </div>
                                    
                                    <div className="bg-white p-3 rounded-xl border opacity-70">
                                        <div className="flex justify-between items-center mb-2">
                                            <span className="font-bold text-gray-800">‚úàÔ∏è Air India</span>
                                            <span className="font-bold text-gray-600">‚Çπ5,100</span>
                                        </div>
                                        <button className="mt-3 w-full bg-gray-100 text-gray-500 py-1.5 rounded-lg text-xs font-bold">Select Flight</button>
                                    </div>
                                </div>
                            )}

                            {/* Hotel Cards */}
                            {msg.type === 'hotels' && (
                                <div className="space-y-3">
                                    <div className="bg-white rounded-xl border overflow-hidden shadow-sm" onClick={handleHotelSelect}>
                                        <div className="h-24 bg-gray-300 relative flex items-center justify-center text-gray-500">
                                            [Hotel Image]
                                            <div className="absolute bottom-2 left-2 bg-white px-2 py-1 rounded text-xs font-bold flex gap-1 items-center">
                                                ‚≠ê 4.8
                                            </div>
                                        </div>
                                        <div className="p-3">
                                            <h3 className="font-bold text-gray-800">Grand Mercure</h3>
                                            <p className="text-xs text-gray-500 flex items-center gap-1 mb-2">üìç Koramangala (1.2 km from office)</p>
                                            <div className="flex justify-between items-end">
                                                <div className="text-xs text-gray-500">2 Nights ‚Ä¢ Business Room</div>
                                                <div className="font-bold text-indigo-600">‚Çπ6,500<span className="text-xs text-gray-400 font-normal">/night</span></div>
                                            </div>
                                            <button className="mt-3 w-full bg-indigo-600 text-white py-2 rounded-lg text-xs font-bold">Book This Hotel</button>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Extras (Cab) */}
                            {msg.type === 'extras' && (
                                <div className="flex gap-2">
                                    <button onClick={() => handleExtrasSelect('yes')} className="flex-1 bg-white border border-indigo-200 p-3 rounded-xl flex flex-col items-center gap-2 hover:bg-indigo-50">
                                        <span className="text-2xl">üöñ</span>
                                        <span className="text-xs font-bold text-indigo-700">Add Cab (+‚Çπ800)</span>
                                    </button>
                                    <button onClick={() => handleExtrasSelect('no')} className="flex-1 bg-white border border-gray-200 p-3 rounded-xl flex flex-col items-center gap-2">
                                        <span className="text-xs font-bold text-gray-500 mt-auto">Skip</span>
                                    </button>
                                </div>
                            )}

                            {/* Summary Bill */}
                            {msg.type === 'summary' && (
                                <div className="bg-white p-4 rounded-xl border border-gray-200">
                                    <h3 className="font-bold text-gray-900 border-b pb-2 mb-2">Trip Summary</h3>
                                    <div className="space-y-2 text-xs text-gray-600">
                                        <div className="flex justify-between">
                                            <span>Flight (DEL-BLR Round)</span>
                                            <span>‚Çπ8,400</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span>Hotel (2 Nights)</span>
                                            <span>‚Çπ13,000</span>
                                        </div>
                                        <div className="flex justify-between">
                                            <span>Airport Transfer</span>
                                            <span>‚Çπ800</span>
                                        </div>
                                        <div className="flex justify-between font-bold text-gray-900 text-sm pt-2 border-t mt-2">
                                            <span>Total</span>
                                            <span>‚Çπ22,200</span>
                                        </div>
                                    </div>
                                    <button onClick={handlePayment} className="mt-4 w-full bg-black text-white py-3 rounded-xl font-bold text-sm flex justify-center items-center gap-2">
                                        Pay with Saved Card
                                    </button>
                                </div>
                            )}

                            {/* Success State */}
                            {msg.type === 'payment_success' && (
                                <div className="bg-green-50 p-4 rounded-xl border border-green-200 text-center">
                                    <div className="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-2">
                                        <IconCheck />
                                    </div>
                                    <h3 className="font-bold text-green-800 mb-1">Booking Confirmed!</h3>
                                    <p className="text-xs text-green-700 mb-4">Your trip to Bengaluru is set.</p>
                                    
                                    <div className="grid grid-cols-2 gap-2">
                                        <button className="bg-white border border-green-200 py-2 rounded-lg text-xs font-bold text-green-700 flex flex-col items-center justify-center gap-1">
                                            üìÑ Download Ticket
                                        </button>
                                        <button className="bg-white border border-green-200 py-2 rounded-lg text-xs font-bold text-green-700 flex flex-col items-center justify-center gap-1">
                                            üìÖ Add to Calendar
                                        </button>
                                    </div>
                                </div>
                            )}

                            </div>
                        </div>
                        ))}

                        {isTyping && (
                        <div className="flex justify-start">
                             <div className="mr-2 mt-1"><IconAI /></div>
                            <div className="bg-gray-200 rounded-2xl rounded-bl-none p-3 w-16 flex items-center gap-1">
                                <div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce"></div>
                                <div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce delay-100"></div>
                                <div className="w-2 h-2 bg-gray-500 rounded-full animate-bounce delay-200"></div>
                            </div>
                        </div>
                        )}
                        <div ref={chatEndRef} />
                    </div>

                    {/* Input Area */}
                    <div className="bg-white p-4 border-t z-10">
                        {step === 0 && (
                            <div className="flex gap-2 overflow-x-auto mb-3 pb-1 no-scrollbar">
                                <button onClick={() => setInput("Business trip to Bengaluru next week")} className="whitespace-nowrap bg-indigo-50 text-indigo-700 px-3 py-1.5 rounded-full text-xs font-semibold border border-indigo-100">üíº Work trip to BLR</button>
                                <button className="whitespace-nowrap bg-indigo-50 text-indigo-700 px-3 py-1.5 rounded-full text-xs font-semibold border border-indigo-100">üèñÔ∏è Solo trip to Kerala</button>
                            </div>
                        )}
                        
                        <div className="flex gap-2 items-center bg-gray-100 px-4 py-2 rounded-full border focus-within:ring-2 ring-indigo-500 transition-all">
                            <input 
                                type="text" 
                                value={input}
                                onChange={(e) => setInput(e.target.value)}
                                placeholder="Ask Yatrafy..."
                                className="bg-transparent flex-1 outline-none text-sm text-gray-700"
                                onKeyPress={(e) => e.key === 'Enter' && handleSend()}
                            />
                            <button onClick={handleSend} className={`p-2 rounded-full transition-all ${input || step === 0 ? 'bg-indigo-600 text-white' : 'bg-gray-300 text-gray-500'}`}>
                                <IconSend />
                            </button>
                        </div>
                    </div>

                    {/* Bottom Nav */}
                    <div className="bg-white border-t flex justify-around py-3 pb-6 rounded-b-[2.5rem]">
                        <div className="flex flex-col items-center gap-1 text-gray-400">
                            <div className="w-5 h-5 bg-gray-300 rounded-sm"></div>
                            <span className="text-[10px]">Home</span>
                        </div>
                        <div className="flex flex-col items-center gap-1 text-indigo-600">
                            <div className="w-5 h-5 bg-indigo-600 rounded-sm flex items-center justify-center text-white text-[10px]">AI</div>
                            <span className="text-[10px] font-bold">Assistant</span>
                        </div>
                        <div className="flex flex-col items-center gap-1 text-gray-400">
                            <div className="w-5 h-5 bg-gray-300 rounded-sm"></div>
                            <span className="text-[10px]">Trips</span>
                        </div>
                        <div className="flex flex-col items-center gap-1 text-gray-400">
                            <div className="w-5 h-5 bg-gray-300 rounded-sm"></div>
                            <span className="text-[10px]">Profile</span>
                        </div>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<YatrafyChat />);
    </script>
</body>
</html>
